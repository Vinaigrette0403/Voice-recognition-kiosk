<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í‚¤ì˜¤ìŠ¤í¬ ì‹œì‘</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #5c3a1e;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        #intro {
            cursor: pointer;
            text-align: center;
        }
        #intro img {
            max-width: 400px;
            border-radius: 20px;
        }
    </style>
</head>
<body>
    <div id="intro" onclick="goToMenu()">
        <img src="{{ url_for('static', filename='images/c.png') }}" alt="ë¡œê³ ">
    </div>

    <audio autoplay>
        <source src="{{ url_for('static', filename='welcome.mp3') }}" type="audio/mpeg">
        ë¸Œë¼ìš°ì €ê°€ ì˜¤ë””ì˜¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    </audio>

    <!-- ğŸ”¥ ìŒì„± ì¸ì‹ ë²„íŠ¼ (ìˆ¨ê²¨ì ¸ ìˆìŒ) -->
    <button id="voiceBtn" style="display:none;">Voice</button>

    <script>
        function goToMenu() {
            window.location.href = "{{ url_for('menu') }}";
        }

        // ğŸ”Š ìŒì„± ì¸ì‹ ì‹œì‘ í•¨ìˆ˜
        function startVoiceRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) {
                alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return;
            }

            const recognition = new SpeechRecognition();
            recognition.lang = "ko-KR";  // í•œêµ­ì–´ ì¸ì‹
            recognition.continuous = false; // í•œ ë¬¸ì¥ë§Œ ì¸ì‹
            recognition.interimResults = false;

            recognition.start();

            recognition.onresult = (event) => {
                const result = event.results[0][0].transcript;
                console.log("ìŒì„± ì¸ì‹ ê²°ê³¼:", result);

                // ëª…ë ¹ì–´ ì²˜ë¦¬
                if (result.includes("ë‹¤ìŒ í™”ë©´ìœ¼ë¡œ") || result.includes("ë‹¤ìŒ í™”ë©´") || result.includes("ë„˜ê²¨")) {
                    goToMenu();
                } else {
                    alert("ì¸ì‹ëœ ë¬¸ì¥: " + result + "\në©”ë‰´ ì´ë™ ëª…ë ¹ì´ ì•„ë‹™ë‹ˆë‹¤.");
                }
            };

            recognition.onerror = (event) => {
                console.log("ìŒì„± ì¸ì‹ ì˜¤ë¥˜:", event.error);
            };
        }

        // ğŸ”µ í˜ì´ì§€ ë¡œë“œ í›„ ìë™ ìŒì„± ì•ˆë‚´ & **3ì´ˆ ë’¤ ìŒì„± ì¸ì‹ ì‹œì‘**
        window.addEventListener("load", () => {
            const audio = new Audio("{{ url_for('static', filename='welcome.mp3') }}");
            audio.play().catch(e => console.warn("ìë™ì¬ìƒ ì°¨ë‹¨ë¨:", e));

            // ìŒì„± ì•ˆë‚´ í›„ 3ì´ˆ ë’¤ì— ìŒì„± ì¸ì‹ ì‹œì‘
            setTimeout(() => {
                startVoiceRecognition();
            }, 3000);
        });
    </script>
</body>
</html>